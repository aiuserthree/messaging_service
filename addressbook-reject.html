<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>수신거부 관리 - 메시징 서비스</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/layout.css">
</head>
<body>
    <div class="app-container">
        <!-- 헤더 -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html" style="text-decoration: none; color: inherit;">
                        <h1>iSend</h1>
                    </a>
                </div>
                <nav class="main-nav">
                    <a href="index.html" class="nav-item">대시보드</a>
                    <div class="nav-item has-dropdown">
                        <a href="#" class="nav-link">문자 발송</a>
                        <div class="nav-dropdown">
                            <a href="message-send-general.html" class="nav-dropdown-item">일반문자 발송</a>
                            <a href="message-send-ad.html" class="nav-dropdown-item">광고문자 발송</a>
                            <a href="message-send-election.html" class="nav-dropdown-item">공직선거문자 발송</a>
                        </div>
                    </div>
                    <div class="nav-item has-dropdown">
                        <a href="#" class="nav-link">카톡 발송</a>
                        <div class="nav-dropdown">
                            <a href="kakao-send-alimtalk.html" class="nav-dropdown-item">알림톡 발송</a>
                            <a href="kakao-send-brandtalk.html" class="nav-dropdown-item">브랜드톡 발송</a>
                        </div>
                    </div>
                    <div class="nav-item has-dropdown">
                        <a href="#" class="nav-link">템플릿</a>
                        <div class="nav-dropdown">
                            <a href="template-message.html" class="nav-dropdown-item">문자</a>
                            <a href="template-alimtalk.html" class="nav-dropdown-item">알림톡</a>
                            <a href="template-brandtalk.html" class="nav-dropdown-item">브랜드톡</a>
                        </div>
                    </div>
                    <div class="nav-item has-dropdown active">
                        <a href="#" class="nav-link">주소록</a>
                        <div class="nav-dropdown">
                            <a href="addressbook.html" class="nav-dropdown-item">주소록 관리</a>
                            <a href="addressbook-reject.html" class="nav-dropdown-item active">수신거부관리</a>
                        </div>
                    </div>
                    <div class="nav-item has-dropdown">
                        <a href="#" class="nav-link">발송 관리</a>
                        <div class="nav-dropdown">
                            <a href="send-result.html" class="nav-dropdown-item">발송결과</a>
                            <a href="send-reservation.html" class="nav-dropdown-item">예약내역</a>
                        </div>
                    </div>
                    <div class="nav-item has-dropdown">
                        <a href="#" class="nav-link">결제 관리</a>
                        <div class="nav-dropdown">
                            <a href="payment-charge.html" class="nav-dropdown-item">충전하기</a>
                            <a href="payment-history.html" class="nav-dropdown-item">충전/사용 내역</a>
                            <a href="payment-tax.html" class="nav-dropdown-item">세금계산서 발행</a>
                        </div>
                    </div>
                    <div class="nav-item has-dropdown">
                        <a href="#" class="nav-link">마이페이지</a>
                        <div class="nav-dropdown">
                            <a href="mypage-profile.html" class="nav-dropdown-item">내 정보 수정</a>
                            <a href="mypage-caller-number.html" class="nav-dropdown-item">발신번호 관리</a>
                        </div>
                    </div>
                </nav>
                <div class="header-actions">
                    <div class="balance-info">
                        <span class="balance-label">잔액</span>
                        <span class="balance-amount">1,000,000원</span>
                    </div>
                    <button class="btn btn-sm btn-outline">로그아웃</button>
                </div>
            </div>
        </header>

        <!-- 메인 컨텐츠 -->
        <main class="main-content">
            <div class="page-header">
                <h2>수신거부 관리</h2>
                <p class="page-description">수신거부를 요청한 고객의 전화번호를 관리합니다</p>
            </div>

            <!-- 통계 요약 -->
            <div class="dashboard-grid" style="margin-bottom: 24px;">
                <div class="stat-card">
                    <div class="stat-icon">🚫</div>
                    <div class="stat-content">
                        <h3>전체 수신거부</h3>
                        <p class="stat-value">1,234명</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📅</div>
                    <div class="stat-content">
                        <h3>이번 달 추가</h3>
                        <p class="stat-value">45명</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-content">
                        <h3>등록 경로</h3>
                        <p class="stat-value">수동: 80%</p>
                    </div>
                </div>
            </div>

            <!-- 검색 및 필터 -->
            <div class="card">
                <div class="search-filter-section">
                    <div style="flex: 1; min-width: 200px;">
                        <input type="text" class="form-input" placeholder="전화번호로 검색">
                    </div>
                    <button class="btn btn-primary">검색</button>
                    <button class="btn btn-outline">초기화</button>
                </div>
            </div>

            <!-- 수신거부 목록 -->
            <div class="card">
                <div class="template-actions">
                    <div>
                        <button class="btn btn-primary" onclick="openModal('addRejectModal')">수신거부 추가</button>
                        <button class="btn btn-outline" onclick="openModal('excelUploadModal')">엑셀 업로드</button>
                    </div>
                    <div class="flex gap-2">
                        <button class="btn btn-outline btn-sm" onclick="deleteSelected()">선택 삭제</button>
                        <button class="btn btn-outline btn-sm">엑셀 다운로드</button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th style="width: 50px;"><input type="checkbox" onclick="toggleAll(this)"></th>
                                <th>전화번호</th>
                                <th>등록일</th>
                                <th>등록 경로</th>
                                <th>메모</th>
                                <th>관리</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="checkbox"></td>
                                <td>010-1234-5678</td>
                                <td>2024-01-15 14:30</td>
                                <td>수동 등록</td>
                                <td>-</td>
                                <td>
                                    <button class="btn btn-sm btn-outline" onclick="deleteReject(1)">삭제</button>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox"></td>
                                <td>010-2345-6789</td>
                                <td>2024-01-14 10:20</td>
                                <td>080 수신거부</td>
                                <td>자동 동기화</td>
                                <td>
                                    <button class="btn btn-sm btn-outline" onclick="deleteReject(2)">삭제</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- 페이지네이션 -->
                <div id="pagination" style="margin-top: 24px;"></div>
            </div>
        </main>
    </div>

    <!-- 수신거부 추가 모달 -->
    <div class="modal-overlay" id="addRejectModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">수신거부 추가</h3>
                <button class="modal-close" onclick="closeModal('addRejectModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label required">전화번호</label>
                    <input type="text" class="form-input" placeholder="010-1234-5678" required>
                    <div class="form-help">하이픈(-) 포함 또는 숫자만 입력 가능합니다</div>
                </div>
                <div class="form-group">
                    <label class="form-label">메모</label>
                    <textarea class="form-textarea" rows="3" placeholder="메모 입력 (선택사항)" maxlength="200"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('addRejectModal')">취소</button>
                <button class="btn btn-primary" onclick="addReject()">추가</button>
            </div>
        </div>
    </div>

    <!-- 엑셀 업로드 모달 -->
    <div class="modal-overlay" id="excelUploadModal">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">엑셀 업로드</h3>
                <button class="modal-close" onclick="closeModal('excelUploadModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <button type="button" class="btn btn-outline" onclick="downloadSample()">샘플 다운로드</button>
                    <div class="form-help">엑셀 샘플 파일을 다운로드하여 양식에 맞게 작성하세요</div>
                </div>
                <div class="form-group">
                    <label class="form-label">파일 선택</label>
                    <input type="file" class="form-input" accept=".xlsx,.xls,.csv" onchange="handleExcelUpload(event)">
                    <div class="form-help">지원 형식: .xlsx, .xls, .csv (최대 10MB, 최대 10,000건)</div>
                </div>
                <div id="excelResult" style="display: none; margin-top: 16px;">
                    <div class="alert alert-success">
                        <strong>검증 완료</strong>
                        <div style="margin-top: 8px;">
                            전체 <span id="excelTotal">0</span>건 중 <span id="excelValid">0</span>건 등록 가능<br>
                            중복 제외: <span id="excelDuplicate">0</span>건<br>
                            형식 오류: <span id="excelError">0</span>건
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('excelUploadModal')">취소</button>
                <button class="btn btn-primary" onclick="applyExcelData()">등록하기</button>
            </div>
        </div>
    </div>

    <!-- 삭제 확인 모달 -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">수신거부 삭제</h3>
                <button class="modal-close" onclick="closeModal('deleteModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>선택한 번호를 수신거부 목록에서 삭제하시겠습니까?</p>
                <div class="alert alert-warning" style="margin-top: 16px;">
                    삭제된 번호는 다시 발송 대상에 포함됩니다.
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('deleteModal')">취소</button>
                <button class="btn btn-danger" onclick="confirmDelete()">삭제</button>
            </div>
        </div>
    </div>

    <script src="js/common.js"></script>
    <script>
        function addReject() {
            showToast('수신거부 번호가 추가되었습니다.', 'success');
            closeModal('addRejectModal');
        }

        function deleteReject(id) {
            openModal('deleteModal');
        }

        function confirmDelete() {
            showToast('수신거부 번호가 삭제되었습니다.', 'success');
            closeModal('deleteModal');
        }

        function deleteSelected() {
            openModal('deleteModal');
        }

        function toggleAll(checkbox) {
            document.querySelectorAll('tbody input[type="checkbox"]').forEach(cb => {
                cb.checked = checkbox.checked;
            });
        }

        function downloadSample() {
            showToast('샘플 파일 다운로드가 시작됩니다.', 'info');
        }

        function handleExcelUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            setTimeout(() => {
                document.getElementById('excelResult').style.display = 'block';
                document.getElementById('excelTotal').textContent = '100';
                document.getElementById('excelValid').textContent = '95';
                document.getElementById('excelDuplicate').textContent = '3';
                document.getElementById('excelError').textContent = '2';
            }, 1000);
        }

        function applyExcelData() {
            showToast('수신거부 번호가 등록되었습니다.', 'success');
            closeModal('excelUploadModal');
        }

        // 페이지네이션 생성
        createPagination(1, 5, 'pagination');
    </script>
</body>
</html>

